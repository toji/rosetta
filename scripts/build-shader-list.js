// Run from the project root.
const fs = require('fs');

const targetFolder = './categories/';

const shaderList = {};

function formatName(name) {
  const parts = name.split('-');
  for (let i = 0; i < parts.length; ++i) {
    parts[i] = parts[i][0].toUpperCase() + parts[i].substr(1);
  }
  return parts.join(' ');
}

fs.readdirSync(targetFolder).forEach(folder => {
  const files = {};

  fs.readdirSync(`${targetFolder}${folder}`).forEach(file => {
    const filenameParts = file.split('.');
    const filename = filenameParts.shift();
    const formatted = formatName(filename);
    const extension = filenameParts.join('.');

    if (!files[formatted]) {
      files[formatted] = {
        name: formatted,
        url: `${targetFolder}${folder}/${filename}`,
        extensions: []
      };
    }

    files[formatted].extensions.unshift(extension);
  });

  shaderList[formatName(folder)] = files;
});

const shaderListContent = `// This file is autogenerated, Do not edit it by hand.
// Rebuild by running:

// node scripts/build-shader-list.js.

export const shaderList = ${JSON.stringify(shaderList, null, 2)};
`;
fs.writeFileSync('./shader-list.js', shaderListContent);
